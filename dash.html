<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>POADDA Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --yellow:#ffcc00;
  --yellow-soft:rgba(255,204,0,.25);
}

body{
  margin:0;
  font-family:'Segoe UI',sans-serif;
  background:linear-gradient(135deg,#fff3b0,#ffd84d,#ffcc00);
  min-height:100vh;
  color:#222;
}

/* HEADER */
header{text-align:center;padding:22px 15px 10px;}
.logo{display:flex;flex-direction:column;align-items:center;gap:8px;}
.logo img{height:90px;}
#welcome{margin-top:12px;font-size:22px;}

/* LAYOUT */
.main{
  max-width:1100px;
  margin:30px auto;
  padding:0 20px;
  display:grid;
  grid-template-columns:2fr 1fr;
  gap:22px;
}
@media(max-width:900px){.main{grid-template-columns:1fr;}}

/* GLASS */
.glass{
  background:rgba(255,255,255,.15);
  backdrop-filter:blur(18px);
  border-radius:22px;
  padding:22px;
  box-shadow:0 10px 30px rgba(0,0,0,.35);
  border:1px solid var(--yellow-soft);
}
.glass h3{
  display:grid;
  grid-template-columns:1fr 1fr;
  margin:0 0 14px;
  padding-bottom:8px;
  border-bottom:1px solid rgba(255,204,0,.4);
}

/* VALUES */
.value{
  padding:12px;
  border-radius:14px;
  background:rgba(255,255,255,.18);
  font-weight:600;
}
.single{margin-bottom:10px;}
.row{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
  margin:8px 0;
}
.clickable{cursor:pointer;transition:.25s;}
.clickable:hover{background:var(--yellow-soft);transform:scale(1.03);}

/* PLUS */
.plus{
  font-weight:900;
  font-size:26px;
  margin-right:10px;
  color:#ff6a00;
  cursor:pointer;
}

/* PERFORMANCE */
.perf-item{
  display:flex;
  justify-content:space-between;
  padding:10px;
  margin:8px 0;
  border-radius:14px;
  background:rgba(255,255,255,.18);
  font-weight:600;
}

/* LOGOUT */
.logout{
  margin:30px auto 40px;
  display:block;
  width:200px;
  padding:14px;
  border:none;
  border-radius:30px;
  background:#222;
  color:#fff;
  font-size:16px;
  font-weight:800;
  cursor:pointer;
}

/* CHOOSER MODAL */
.chooser-overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.35);
  backdrop-filter:blur(8px);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:9999;
}

.chooser-card{
  background:#fff;
  padding:28px;
  border-radius:22px;
  width:90%;
  max-width:360px;
  text-align:center;
  animation:pop .3s ease;
}

@keyframes pop{
  from{transform:scale(.7);opacity:0}
  to{transform:scale(1);opacity:1}
}

.chooser-btn{
  width:100%;
  padding:14px;
  margin:8px 0;
  border:none;
  border-radius:30px;
  font-size:15px;
  font-weight:800;
  cursor:pointer;
}
.study{background:#ffcc00;}
.practice{background:#222;color:#fff;}
.cancel{background:#eee;}
</style>
</head>

<body>

<header>
  <div class="logo">
    <img src="logo.png">
    <p><b>POADDA ‚Äì A journey towards excellence.</b></p>
  </div>
  <h2 id="welcome">Welcome üëã</h2>
</header>

<section class="main">

<!-- LEFT -->
<div>
  <div class="glass">
    <h3><span>Your Enrolled Course</span><span>Validity</span></h3>

    <div class="single value clickable" id="cVal"></div>

    <div class="row" id="rowDE">
      <div class="value clickable" id="dVal"></div>
      <div class="value" id="eVal"></div>
    </div>

    <div class="row" id="rowFG">
      <div class="value clickable" id="fVal"></div>
      <div class="value" id="gVal"></div>
    </div>

    <div class="row" id="rowHI">
      <div class="value clickable" id="hVal"></div>
      <div class="value" id="iVal"></div>
    </div>
  </div>

  <!-- YOU MAY ADD -->
  <div class="glass" style="margin-top:22px;">
    <h3><span>You may add ---</span></h3>

    <div class="value" id="kVal">
      <span class="plus">Ôºã</span><span class="text"></span>
    </div>

    <div class="value" id="lVal" style="margin-top:10px;">
      <span class="plus">Ôºã</span><span class="text"></span>
    </div>
  </div>
</div>

<!-- RIGHT : PERFORMANCE -->
<div class="glass">
  <h3><span>Student's Performance</span></h3>

  <div class="perf-item" id="mBox"><span id="mLabel"></span><span id="mVal"></span></div>
  <div class="perf-item" id="nBox"><span id="nLabel"></span><span id="nVal"></span></div>
  <div class="perf-item" id="oBox"><span id="oLabel"></span><span id="oVal"></span></div>
  <div class="perf-item" id="pBox"><span id="pLabel"></span><span id="pVal"></span></div>
  <div class="perf-item" id="qBox"><span id="qLabel"></span><span id="qVal"></span></div>
</div>

</section>

<button class="logout" onclick="logout()">Logout</button>

<!-- STUDY / PRACTICE CHOOSER -->
<div id="chooser" class="chooser-overlay">
  <div class="chooser-card">
    <h3 id="chooserTitle"></h3>
    <button class="chooser-btn study" onclick="goStudy()">üìò Study Material</button>
    <button class="chooser-btn practice" onclick="goPractice()">üìù Practice Set</button>
    <button class="chooser-btn cancel" onclick="closeChooser()">‚ùå Cancel</button>
  </div>
</div>

<script>
const SCRIPT_URL="https://script.google.com/macros/s/AKfycbxUsrfTteoJMK5j5qnEspa_ZKxS1dpp63o_WboQl48m22o_CBJ8CbzpLCXXG8uKaGOw-w/exec";
const mobile=localStorage.getItem("mobile");

let currentExam="";

fetch(`${SCRIPT_URL}?mobile=${mobile}`)
.then(r=>r.json())
.then(d=>{
  // üîê STORE USER INFO GLOBALLY
if (d.name) localStorage.setItem("userName", d.name);
if (mobile) localStorage.setItem("userMobile", mobile);

welcome.innerText = "Welcome üëã " + (d.name || "");


  setVal(cVal,d.C);
  setRow(rowDE,dVal,d.D,eVal,d.E);
  setRow(rowFG,fVal,d.F,gVal,d.G);
  setRow(rowHI,hVal,d.H,iVal,d.I);

  setPlus(kVal,d.K);
  setPlus(lVal,d.L);

  setPerf("m",d.performance.M);
  setPerf("n",d.performance.N);
  setPerf("o",d.performance.O);
  setPerf("p",d.performance.P);
  setPerf("q",d.performance.Q);

  document.querySelectorAll(".clickable").forEach(el=>{
    el.onclick=e=>{
      e.stopPropagation();
      const link=el.dataset.link;
      if(!link) return;

      if(link.startsWith("Study-Material+Practice-Set")){
        currentExam=link.split("-").pop();
        chooserTitle.innerText="Choose for "+currentExam;
        chooser.style.display="flex";
        return;
      }
      const name = localStorage.getItem("userName") || "";
const mob  = localStorage.getItem("userMobile") || "";

location.href =
  `${link}.html?name=${encodeURIComponent(name)}&mobile=${encodeURIComponent(mob)}`;

    };
  });
});

function setVal(el,v){
  if(!v){el.style.display="none";return;}
  el.innerText=v;
  el.dataset.link=v;
}
function setRow(r,a,av,b,bv){
  if(!av&&!bv){r.style.display="none";return;}
  setVal(a,av);setVal(b,bv);
}
function setPlus(el, v){
  if(!v){
    el.style.display="none";
    return;
  }

  const textSpan = el.querySelector(".text");
  textSpan.innerText = v;

  // make whole block clickable
  el.style.cursor = "pointer";
  el.onclick = () => {
    location.href = "purchase.html";
  };

  // also make + explicitly clickable
  const plus = el.querySelector(".plus");
  plus.onclick = (e) => {
    e.stopPropagation(); // prevent double trigger
    location.href = "purchase.html";
  };
}
function setPerf(p,o){
  if(!o?.value){document.getElementById(p+"Box").style.display="none";return;}
  document.getElementById(p+"Label").innerText=o.label;
  document.getElementById(p+"Val").innerText=o.value;
}

function goStudy(){
  const name = localStorage.getItem("userName") || "";
  const mob  = localStorage.getItem("userMobile") || "";
  location.href =
    `Study-Material-${currentExam}.html?name=${encodeURIComponent(name)}&mobile=${encodeURIComponent(mob)}`;
}

function goPractice(){
  const name = localStorage.getItem("userName") || "";
  const mob  = localStorage.getItem("userMobile") || "";
  location.href =
    `Practice-Set-${currentExam}.html?name=${encodeURIComponent(name)}&mobile=${encodeURIComponent(mob)}`;
}
function closeChooser(){chooser.style.display="none";}

function logout(){
  if(confirm("Are you sure you want to logout?")){
    localStorage.clear();
    location.replace("login.html");
  }
}
</script>

</body>
</html>
